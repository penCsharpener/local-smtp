@using Microsoft.AspNetCore.SignalR.Client
@inject NavigationManager Nav
@inject HttpClient httpClient
@implements IAsyncDisposable

<MudGrid Spacing="0">
  <MudItem xs="6">
    <MudGrid Spacing="0">
      <MudItem xs="12">
        <MudButtonGroup Color="Color.Primary" Variant="Variant.Filled" Style="margin-top: 18px;">
          <MudButton StartIcon="@Icons.Material.Filled.Close"></MudButton>
          <MudButton StartIcon="@Icons.Material.Filled.Delete"></MudButton>
          <MudButton StartIcon="@Icons.Material.Filled.Refresh"></MudButton>
          <MudButton StartIcon="@Icons.Material.Filled.FastForward"></MudButton>
        </MudButtonGroup>
      </MudItem>

    </MudGrid>

    <div class="divider">
      <MudDivider />
    </div>

    <MudTable Items="@Elements" @ref="mudTable" FixedHeader="true" FixedFooter="true" Dense="true" Hover="true" Bordered="false" Striped="true" 
      Virtualize="true" Height="100%" Filter="new Func<MessageSummary,bool>(FilterFunc1)" RowStyleFunc="@SelectedRowStyleFunc"
        @bind-SelectedItem="SelectedMessage" RowsPerPage="50">
      <ToolBarContent>
        <MudText Typo="Typo.h6">Messages</MudText>
        <MudSpacer />
        <MudTextField @bind-Value="searchString" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
      </ToolBarContent>
      <HeaderContent>
        <MudTh>Received</MudTh>
        <MudTh>From</MudTh>
        <MudTh>To</MudTh>
        <MudTh>Subject</MudTh>
      </HeaderContent>
      <RowTemplate>
        <MudTd DataLabel="Received">@context.ReceivedDate</MudTd>
        <MudTd DataLabel="From">@context.From</MudTd>
        <MudTd DataLabel="To">@context.To</MudTd>
        <MudTd DataLabel="Subject">@context.Subject</MudTd>
      </RowTemplate>
      <PagerContent>
        <MudTablePager PageSizeOptions="new int[] {50, 100, 200}"/>
      </PagerContent>
    </MudTable>
  </MudItem>
  <MudItem xs="6">
    <pre style="padding: 16px;">
      @_messageRaw
    </pre>
  </MudItem>
</MudGrid>

